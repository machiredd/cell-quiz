<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Cell Quiz</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', sans-serif;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Lucide icons as SVG components
        const Check = () => (
            <svg width="120" height="120" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <polyline points="20 6 9 17 4 12"></polyline>
            </svg>
        );

        const X = () => (
            <svg width="120" height="120" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <line x1="18" y1="6" x2="6" y2="18"></line>
                <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
        );

        const RotateCcw = ({ size = 24 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <polyline points="1 4 1 10 7 10"></polyline>
                <path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"></path>
            </svg>
        );

        const QrCode = ({ size = 24 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <rect x="3" y="3" width="7" height="7"></rect>
                <rect x="14" y="3" width="7" height="7"></rect>
                <rect x="3" y="14" width="7" height="7"></rect>
                <path d="M14 14h3"></path>
                <path d="M19 14h2"></path>
                <path d="M14 19h2"></path>
                <path d="M19 19h2"></path>
            </svg>
        );

        const Download = ({ size = 20 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                <polyline points="7 10 12 15 17 10"></polyline>
                <line x1="12" y1="15" x2="12" y2="3"></line>
            </svg>
        );

        const Trophy = ({ size = 60 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"></path>
                <path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"></path>
                <path d="M4 22h16"></path>
                <path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22"></path>
                <path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22"></path>
                <path d="M18 2H6v7a6 6 0 0 0 12 0V2Z"></path>
            </svg>
        );

        const Star = ({ size = 24 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" strokeWidth="2">
                <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>
            </svg>
        );

        function CellQuiz() {
            // Species configuration
            const speciesConfig = {
                dog: {
                    name: 'Dog',
                    emoji: '🐕',
                    folder: 'dog',
                    gradient: 'from-amber-500 to-orange-600',
                    cellNames: {
                        neutrophil: 'Neutrophil',
                        neutrophilShort: 'Neutrophil',
                        lymphocyte: 'Lymphocyte',
                        lymphocyteShort: 'Lymphocyte',
                        monocyte: 'Monocyte',
                        monocyteShort: 'Monocyte',
                        eosinophil: 'Eosinophil',
                        eosinophilShort: 'Eosinophil'
                    }
                },
                parrot: {
                    name: 'Parrot',
                    emoji: '🦜',
                    folder: 'parrot',
                    gradient: 'from-green-500 to-emerald-600',
                    cellNames: {
                        neutrophil: 'Heterophil',
                        neutrophilShort: 'Heterophil',
                        lymphocyte: 'Lymphocyte',
                        lymphocyteShort: 'Lymphocyte',
                        monocyte: 'Monocyte',
                        monocyteShort: 'Monocyte',
                        eosinophil: 'Eosinophil',
                        eosinophilShort: 'Eosinophil'
                    }
                }
            };

            // Cell image structure - will be populated based on species choice
            const getCellImages = (species) => ({
                neutrophil: [
                    `${species}/neutrophil1.png`,
                    `${species}/neutrophil2.png`,
                    `${species}/neutrophil3.png`,
                    `${species}/neutrophil4.png`,
                    `${species}/neutrophil5.png`
                ],
                lymphocyte: [
                    `${species}/lymphocyte1.png`,
                    `${species}/lymphocyte2.png`,
                    `${species}/lymphocyte3.png`,
                    `${species}/lymphocyte4.png`,
                    `${species}/lymphocyte5.png`
                ],
                monocyte: [
                    `${species}/monocyte1.png`,
                    `${species}/monocyte2.png`,
                    `${species}/monocyte3.png`,
                    `${species}/monocyte4.png`,
                    `${species}/monocyte5.png`
                ],
                eosinophil: [
                    `${species}/eosinophil1.png`,
                    `${species}/eosinophil2.png`,
                    `${species}/eosinophil3.png`,
                    `${species}/eosinophil4.png`,
                    `${species}/eosinophil5.png`
                ]
            });

            // Level configurations
            const levels = [
                {
                    level: 1,
                    title: "Level 1: [Neutrophil] vs Lymphocytes",
                    cellTypes: ['neutrophil', 'lymphocyte'],
                    colors: ['from-pink-500 to-rose-500', 'from-indigo-500 to-blue-500']
                },
                {
                    level: 2,
                    title: "Level 2: [Neutrophil] vs Monocytes",
                    cellTypes: ['neutrophil', 'monocyte'],
                    colors: ['from-pink-500 to-rose-500', 'from-purple-500 to-violet-500']
                },
                {
                    level: 3,
                    title: "Level 3: Monocytes vs Eosinophils",
                    cellTypes: ['monocyte', 'eosinophil'],
                    colors: ['from-purple-500 to-violet-500', 'from-orange-500 to-red-500']
                },
                {
                    level: 4,
                    title: "Level 4: Eosinophils vs [Neutrophil]",
                    cellTypes: ['eosinophil', 'neutrophil'],
                    colors: ['from-orange-500 to-red-500', 'from-pink-500 to-rose-500']
                },
                {
                    level: 5,
                    title: "Level 5: All Cell Types!",
                    cellTypes: ['neutrophil', 'monocyte', 'lymphocyte', 'eosinophil'],
                    colors: ['from-pink-500 to-rose-500', 'from-purple-500 to-violet-500', 'from-indigo-500 to-blue-500', 'from-orange-500 to-red-500']
                }
            ];

            const [selectedSpecies, setSelectedSpecies] = useState(null);
            const [allCellImages, setAllCellImages] = useState(null);
            const [currentLevel, setCurrentLevel] = useState(0);
            const [levelImages, setLevelImages] = useState([]);
            const [currentIndex, setCurrentIndex] = useState(0);
            const [score, setScore] = useState(0);
            const [levelScores, setLevelScores] = useState([0, 0, 0, 0, 0]);
            const [selectedAnswer, setSelectedAnswer] = useState(null);
            const [showFeedback, setShowFeedback] = useState(false);
            const [levelFinished, setLevelFinished] = useState(false);
            const [allLevelsComplete, setAllLevelsComplete] = useState(false);
            const [showQR, setShowQR] = useState(false);
            const [qrCodeUrl, setQrCodeUrl] = useState('');

            const chooseSpecies = (species) => {
                setSelectedSpecies(species);
                setAllCellImages(getCellImages(speciesConfig[species].folder));
            };

            useEffect(() => {
                if (allCellImages) {
                    startLevel(0);
                }
            }, [allCellImages]);

            const startLevel = (levelIndex) => {
                const level = levels[levelIndex];
                const images = [];

                const imagesPerType = levelIndex === 4 ? 2 : 3;
                
                level.cellTypes.forEach(cellType => {
                    const cellImages = [...allCellImages[cellType]].sort(() => Math.random() - 0.5).slice(0, imagesPerType);
                    cellImages.forEach(img => {
                        images.push({ url: img, type: cellType });
                    });
                });

                const shuffled = images.sort(() => Math.random() - 0.5);
                
                setLevelImages(shuffled);
                setCurrentIndex(0);
                setScore(0);
                setSelectedAnswer(null);
                setShowFeedback(false);
                setLevelFinished(false);
            };

            const handleAnswer = (answer) => {
                if (showFeedback) return;
                
                setSelectedAnswer(answer);
                setShowFeedback(true);
                
                const isCorrect = answer === levelImages[currentIndex].type;
                if (isCorrect) {
                    setScore(score + 1);
                }

                setTimeout(() => {
                    if (currentIndex < levelImages.length - 1) {
                        setCurrentIndex(currentIndex + 1);
                        setSelectedAnswer(null);
                        setShowFeedback(false);
                    } else {
                        const newScores = [...levelScores];
                        newScores[currentLevel] = isCorrect ? score + 1 : score;
                        setLevelScores(newScores);
                        setLevelFinished(true);
                    }
                }, 1500);
            };

            const nextLevel = () => {
                if (currentLevel < levels.length - 1) {
                    const nextLevelIndex = currentLevel + 1;
                    setCurrentLevel(nextLevelIndex);
                    startLevel(nextLevelIndex);
                } else {
                    setAllLevelsComplete(true);
                }
            };

            const restartQuiz = () => {
                setSelectedSpecies(null);
                setAllCellImages(null);
                setCurrentLevel(0);
                setLevelScores([0, 0, 0, 0, 0]);
                setAllLevelsComplete(false);
            };

            const generateQRCode = () => {
                const currentUrl = window.location.href;
                const qrUrl = `https://api.qrserver.com/v1/create-qr-code/?size=400x400&data=${encodeURIComponent(currentUrl)}`;
                setQrCodeUrl(qrUrl);
                setShowQR(true);
            };

            const downloadQRCode = () => {
                const link = document.createElement('a');
                link.href = qrCodeUrl;
                link.download = 'cell-quiz-qr-code.png';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            };

            const getCellEmoji = (cellType) => {
                const emojis = {
                    neutrophil: '⚪',
                    lymphocyte: '🔵',
                    monocyte: '🟣',
                    eosinophil: '🔴'
                };
                return emojis[cellType] || '⚪';
            };

            const getCellLabel = (cellType, short = false) => {
                if (!selectedSpecies) return cellType.charAt(0).toUpperCase() + cellType.slice(1);
                const names = speciesConfig[selectedSpecies].cellNames;
                return short ? names[cellType + 'Short'] : names[cellType];
            };

            const getLevelTitle = (levelData) => {
                if (!selectedSpecies) return levelData.title;
                const title = levelData.title.replace(/\[Neutrophil\]/g, speciesConfig[selectedSpecies].cellNames.neutrophil + 's');
                return title;
            };

            // Welcome Screen - Species Selection
            if (!selectedSpecies) {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-purple-600 via-pink-500 to-red-500 flex items-center justify-center p-4">
                        <div className="bg-white rounded-3xl shadow-2xl p-12 max-w-3xl w-full text-center">
                            <h1 className="text-6xl font-black text-gray-800 mb-4">
                                Welcome to...
                            </h1>
                            <h2 className="text-7xl font-black bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent mb-6">
                                THE CELL QUIZ!
                            </h2>
                            <p className="text-3xl text-gray-700 font-semibold mb-12">
                                Can you identify them all? 🔬
                            </p>

                            <div className="mb-8">
                                <h3 className="text-2xl font-bold text-gray-800 mb-6">
                                    Choose Your Species:
                                </h3>
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <button
                                        onClick={() => chooseSpecies('dog')}
                                        className="group relative overflow-hidden bg-gradient-to-br from-amber-400 to-orange-500 hover:from-amber-500 hover:to-orange-600 text-white rounded-2xl p-8 transition-all transform hover:scale-105 hover:shadow-2xl"
                                    >
                                        <div className="text-8xl mb-4">🐕</div>
                                        <div className="text-3xl font-bold">Dog</div>
                                        <div className="text-lg opacity-90 mt-2">Canine Cells</div>
                                    </button>

                                    <button
                                        onClick={() => chooseSpecies('parrot')}
                                        className="group relative overflow-hidden bg-gradient-to-br from-green-400 to-emerald-500 hover:from-green-500 hover:to-emerald-600 text-white rounded-2xl p-8 transition-all transform hover:scale-105 hover:shadow-2xl"
                                    >
                                        <div className="text-8xl mb-4">🦜</div>
                                        <div className="text-3xl font-bold">Parrot</div>
                                        <div className="text-lg opacity-90 mt-2">Avian Cells</div>
                                    </button>
                                </div>
                            </div>

                            <div className="bg-blue-50 rounded-2xl p-6 border-2 border-blue-200">
                                <p className="text-gray-700 text-lg">
                                    <strong>5 Levels</strong> • <strong>4 Cell Types</strong> • <strong>Neutrophils, Lymphocytes, Monocytes, Eosinophils</strong>
                                </p>
                            </div>
                        </div>
                    </div>
                );
            }

            // QR Code Screen
            if (showQR) {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-blue-600 to-purple-600 flex items-center justify-center p-4">
                        <div className="bg-white rounded-3xl shadow-2xl p-8 max-w-md w-full text-center">
                            <h2 className="text-3xl font-bold text-gray-800 mb-4">Share Your Quiz! 📱</h2>
                            <p className="text-gray-600 mb-6">Scan this QR code to access the quiz</p>
                            <div className="bg-white p-4 rounded-2xl border-4 border-blue-500 inline-block mb-6">
                                <img src={qrCodeUrl} alt="QR Code" className="w-80 h-80" />
                            </div>
                            <div className="flex gap-4">
                                <button
                                    onClick={downloadQRCode}
                                    className="flex-1 bg-green-600 text-white px-6 py-3 rounded-full font-semibold hover:bg-green-700 transition-all flex items-center justify-center gap-2"
                                >
                                    <Download size={20} />
                                    Download QR
                                </button>
                                <button
                                    onClick={() => setShowQR(false)}
                                    className="flex-1 bg-gray-600 text-white px-6 py-3 rounded-full font-semibold hover:bg-gray-700 transition-all"
                                >
                                    Close
                                </button>
                            </div>
                        </div>
                    </div>
                );
            }

            // All Levels Complete Screen
            if (allLevelsComplete) {
                const totalScore = levelScores.reduce((a, b) => a + b, 0);
                const totalPossible = 32;
                const speciesInfo = speciesConfig[selectedSpecies];
                
                // Calculate performance per cell type
                const cellTypePerformance = {
                    neutrophil: { correct: 0, total: 0 },
                    lymphocyte: { correct: 0, total: 0 },
                    monocyte: { correct: 0, total: 0 },
                    eosinophil: { correct: 0, total: 0 }
                };

                // Level 1: Neutrophils vs Lymphocytes (3 each)
                const level1Score = levelScores[0];
                cellTypePerformance.neutrophil.total += 3;
                cellTypePerformance.lymphocyte.total += 3;
                // Estimate based on score (simplified approximation)
                const level1Estimate = Math.round(level1Score / 2);
                cellTypePerformance.neutrophil.correct += level1Estimate;
                cellTypePerformance.lymphocyte.correct += level1Score - level1Estimate;

                // Level 2: Neutrophils vs Monocytes (3 each)
                const level2Score = levelScores[1];
                cellTypePerformance.neutrophil.total += 3;
                cellTypePerformance.monocyte.total += 3;
                const level2Estimate = Math.round(level2Score / 2);
                cellTypePerformance.neutrophil.correct += level2Estimate;
                cellTypePerformance.monocyte.correct += level2Score - level2Estimate;

                // Level 3: Monocytes vs Eosinophils (3 each)
                const level3Score = levelScores[2];
                cellTypePerformance.monocyte.total += 3;
                cellTypePerformance.eosinophil.total += 3;
                const level3Estimate = Math.round(level3Score / 2);
                cellTypePerformance.monocyte.correct += level3Estimate;
                cellTypePerformance.eosinophil.correct += level3Score - level3Estimate;

                // Level 4: Eosinophils vs Neutrophils (3 each)
                const level4Score = levelScores[3];
                cellTypePerformance.eosinophil.total += 3;
                cellTypePerformance.neutrophil.total += 3;
                const level4Estimate = Math.round(level4Score / 2);
                cellTypePerformance.eosinophil.correct += level4Estimate;
                cellTypePerformance.neutrophil.correct += level4Score - level4Estimate;

                // Level 5: All types (2 each)
                const level5Score = levelScores[4];
                cellTypePerformance.neutrophil.total += 2;
                cellTypePerformance.lymphocyte.total += 2;
                cellTypePerformance.monocyte.total += 2;
                cellTypePerformance.eosinophil.total += 2;
                const level5PerCell = level5Score / 4;
                cellTypePerformance.neutrophil.correct += Math.round(level5PerCell);
                cellTypePerformance.lymphocyte.correct += Math.round(level5PerCell);
                cellTypePerformance.monocyte.correct += Math.round(level5PerCell);
                cellTypePerformance.eosinophil.correct += Math.round(level5PerCell);

                // Calculate percentages
                const cellTypePercentages = {};
                const weakCellTypes = [];
                let allAbove80 = true;

                Object.keys(cellTypePerformance).forEach(cellType => {
                    const perf = cellTypePerformance[cellType];
                    const percentage = (perf.correct / perf.total) * 100;
                    cellTypePercentages[cellType] = percentage;
                    if (percentage < 80) {
                        allAbove80 = false;
                        weakCellTypes.push(getCellLabel(cellType, false));
                    }
                });

                const isExpert = allAbove80;
                
                return (
                    <div className={`min-h-screen bg-gradient-to-br ${speciesInfo.gradient} flex items-center justify-center p-4`}>
                        <div className="bg-white rounded-3xl shadow-2xl p-8 max-w-2xl w-full text-center">
                            <div className="mb-6 flex justify-center">
                                <Trophy size={100} />
                            </div>
                            
                            {isExpert ? (
                                <>
                                    <h1 className="text-5xl font-bold text-gray-800 mb-4">🎉 Congratulations! 🎉</h1>
                                    <div className="text-6xl mb-4">{speciesInfo.emoji}</div>
                                    <h2 className="text-3xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-purple-600 to-pink-600 mb-6">
                                        You are now an expert at identifying {speciesInfo.name.toLowerCase()} cells!
                                    </h2>
                                    <p className="text-xl text-gray-600 mb-8">
                                        You've mastered all cell types with over 80% accuracy! You can confidently identify {speciesInfo.cellNames.neutrophil.toLowerCase()}s, lymphocytes, monocytes, and eosinophils in {speciesInfo.name.toLowerCase()} blood samples!
                                    </p>
                                </>
                            ) : (
                                <>
                                    <h1 className="text-5xl font-bold text-gray-800 mb-4">🌟 Great Effort! 🌟</h1>
                                    <div className="text-6xl mb-4">{speciesInfo.emoji}</div>
                                    <h2 className="text-3xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-600 to-teal-600 mb-6">
                                        You're making excellent progress!
                                    </h2>
                                    <p className="text-xl text-gray-600 mb-4">
                                        You've completed all 5 levels - that's fantastic! Keep practicing to reach expert level.
                                    </p>
                                    <div className="bg-yellow-50 border-2 border-yellow-300 rounded-2xl p-6 mb-8">
                                        <p className="text-lg text-gray-700 font-semibold mb-2">
                                            💡 Focus on improving your identification of:
                                        </p>
                                        <p className="text-xl font-bold text-orange-600">
                                            {weakCellTypes.join(', ')}
                                        </p>
                                        <p className="text-sm text-gray-600 mt-2">
                                            (Score below 80% accuracy)
                                        </p>
                                    </div>
                                </>
                            )}
                            
                            <div className="bg-gradient-to-r from-blue-50 to-purple-50 rounded-2xl p-6 mb-8">
                                <h3 className="text-2xl font-bold text-gray-800 mb-4">Your Scores</h3>
                                <div className="space-y-3">
                                    {levels.map((level, idx) => {
                                        const maxScore = idx === 4 ? 8 : 6;
                                        return (
                                            <div key={idx} className="flex items-center justify-between bg-white rounded-xl p-4">
                                                <span className="font-semibold text-gray-700">Level {level.level}</span>
                                                <div className="flex items-center gap-2">
                                                    <span className="text-2xl font-bold text-blue-600">{levelScores[idx]}/{maxScore}</span>
                                                    {levelScores[idx] === maxScore && <Star size={20} />}
                                                </div>
                                            </div>
                                        );
                                    })}
                                </div>
                                <div className="mt-4 pt-4 border-t-2 border-gray-300">
                                    <div className="flex items-center justify-between">
                                        <span className="text-xl font-bold text-gray-800">Total Score</span>
                                        <span className="text-3xl font-bold text-purple-600">{totalScore}/{totalPossible}</span>
                                    </div>
                                </div>
                            </div>

                            <div className="flex gap-4">
                                <button
                                    onClick={restartQuiz}
                                    className="flex-1 bg-gradient-to-r from-blue-600 to-purple-600 text-white px-8 py-4 rounded-full text-xl font-bold hover:from-blue-700 hover:to-purple-700 transition-all transform hover:scale-105 flex items-center justify-center gap-2"
                                >
                                    <RotateCcw size={28} />
                                    {isExpert ? 'Try Other Species' : 'Practice Again'}
                                </button>
                                <button
                                    onClick={generateQRCode}
                                    className="flex-1 bg-green-600 text-white px-8 py-4 rounded-full text-xl font-bold hover:bg-green-700 transition-all transform hover:scale-105 flex items-center justify-center gap-2"
                                >
                                    <QrCode size={28} />
                                    Share Quiz
                                </button>
                            </div>
                        </div>
                    </div>
                );
            }

            // Level Complete Screen
            if (levelFinished) {
                const currentLevelData = levels[currentLevel];
                const maxScore = currentLevel === 4 ? 8 : 6;
                
                return (
                    <div className="min-h-screen bg-gradient-to-br from-green-500 to-teal-600 flex items-center justify-center p-4">
                        <div className="bg-white rounded-3xl shadow-2xl p-8 max-w-md w-full text-center">
                            <h2 className="text-4xl font-bold text-gray-800 mb-4">Level {currentLevel + 1} Complete!</h2>
                            <div className="text-6xl font-bold text-green-600 mb-2">{score}/{maxScore}</div>
                            <p className="text-xl text-gray-600 mb-8">
                                {score === maxScore ? 'Perfect! 🌟' : 
                                 score >= maxScore * 0.7 ? 'Great job! 👏' : 
                                 'Keep practicing! 💪'}
                            </p>
                            
                            <div className="bg-gray-100 rounded-2xl p-4 mb-8">
                                <div className="flex items-center justify-center gap-2 mb-2">
                                    {[1, 2, 3, 4, 5].map((level) => (
                                        <div
                                            key={level}
                                            className={`w-12 h-12 rounded-full flex items-center justify-center font-bold ${
                                                level <= currentLevel + 1
                                                    ? 'bg-green-500 text-white'
                                                    : 'bg-gray-300 text-gray-600'
                                            }`}
                                        >
                                            {level}
                                        </div>
                                    ))}
                                </div>
                                <p className="text-sm text-gray-600">
                                    {currentLevel === 4 ? 'All levels complete!' : `${4 - currentLevel} level${4 - currentLevel > 1 ? 's' : ''} remaining`}
                                </p>
                            </div>

                            <button
                                onClick={nextLevel}
                                className="w-full bg-gradient-to-r from-green-600 to-teal-600 text-white px-8 py-4 rounded-full text-xl font-bold hover:from-green-700 hover:to-teal-700 transition-all transform hover:scale-105"
                            >
                                {currentLevel === 4 ? 'See Final Results! 🎉' : 'Next Level →'}
                            </button>
                        </div>
                    </div>
                );
            }

            // Quiz Screen
            if (levelImages.length === 0) {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-blue-600 to-purple-600 flex items-center justify-center">
                        <div className="text-white text-2xl">Loading...</div>
                    </div>
                );
            }

            const currentImage = levelImages[currentIndex];
            const isCorrect = selectedAnswer === currentImage.type;
            const currentLevelData = levels[currentLevel];

            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-600 to-purple-600 flex items-center justify-center p-4">
                    <div className="bg-white rounded-3xl shadow-2xl p-8 max-w-2xl w-full">
                        {/* Header */}
                        <div className="mb-6">
                            <div className="flex items-center justify-center gap-2 mb-2">
                                <span className="text-3xl">{speciesConfig[selectedSpecies].emoji}</span>
                                <h1 className="text-2xl font-bold text-center text-gray-800">
                                    {getLevelTitle(currentLevelData)}
                                </h1>
                            </div>
                            <div className="flex justify-between items-center">
                                <div className="text-lg font-semibold text-gray-700">
                                    Image {currentIndex + 1}/{levelImages.length}
                                </div>
                                <div className="text-lg font-semibold text-blue-600">
                                    Score: {score}
                                </div>
                            </div>
                        </div>

                        {/* Image Display */}
                        <div className="mb-6 relative">
                            <img
                                src={currentImage.url}
                                alt="Identify the cell"
                                className="w-full h-80 object-cover rounded-2xl shadow-lg bg-gray-100"
                            />
                            {showFeedback && (
                                <div className={`absolute inset-0 rounded-2xl flex items-center justify-center ${
                                    isCorrect ? 'bg-green-500' : 'bg-red-500'
                                } bg-opacity-90 transition-all`}>
                                    {isCorrect ? <Check /> : <X />}
                                </div>
                            )}
                        </div>

                        <h2 className="text-xl font-bold text-center text-gray-800 mb-4">
                            What type of cell is this?
                        </h2>

                        {/* Answer Buttons */}
                        <div className={`grid gap-3 mb-6 ${currentLevelData.cellTypes.length === 4 ? 'grid-cols-2' : 'grid-cols-2'}`}>
                            {currentLevelData.cellTypes.map((cellType, idx) => (
                                <button
                                    key={cellType}
                                    onClick={() => handleAnswer(cellType)}
                                    disabled={showFeedback}
                                    className={`py-3 px-4 rounded-xl ${currentLevelData.cellTypes.length === 4 ? 'text-base' : 'text-lg'} font-bold transition-all transform hover:scale-105 ${
                                        showFeedback
                                            ? selectedAnswer === cellType
                                                ? isCorrect
                                                    ? 'bg-green-500 text-white'
                                                    : 'bg-red-500 text-white'
                                                : 'bg-gray-200 text-gray-400'
                                            : `bg-gradient-to-r ${currentLevelData.colors[idx]} text-white hover:opacity-90`
                                    }`}
                                >
                                    {getCellEmoji(cellType)} {getCellLabel(cellType, currentLevelData.cellTypes.length === 4)}
                                </button>
                            ))}
                        </div>

                        {/* Progress Bar */}
                        <div className="w-full bg-gray-200 rounded-full h-2">
                            <div
                                className="bg-gradient-to-r from-blue-600 to-purple-600 h-2 rounded-full transition-all"
                                style={{ width: `${((currentIndex + 1) / levelImages.length) * 100}%` }}
                            />
                        </div>
                    </div>
                </div>
            );
        }

        ReactDOM.render(<CellQuiz />, document.getElementById('root'));
    </script>
</body>
</html>